cat << EOF > /etc/sysconfig/flanneld 
FLANNEL_ETCD_ENDPOINTS="http://${ETCD_SERVER}:2379"
FLANNEL_ETCD_PREFIX="/flannel/network"
EOF

cat << EOF > /etc/kubernetes/proxy
KUBE_PROXY_ARGS=""
KUBE_MASTER_SERVER="--master=http://${ETCD_SERVER}:8080"
EOF

cat << EOF > /etc/kubernetes/kubelet
# Listen on all ports
KUBELET_ADDRESS="--address=0.0.0.0"
# Use hostname from os
KUBELET_HOSTNAME=""
# Set URL to API server
KUBELET_API_SERVER="--api-servers=http://${ETCD_SERVER}:8080"
EOF

# Authorize master server
ssh-keyscan -H ${COCKPIT_SERVER} >> /var/lib/cockpit/known_hosts

# kubectl
kubectl config set-cluster default-cluster --server=https://${MASTER_SERVER}:8080
kubectl config set-context default-context --cluster=default-cluster --user=default-admin
kubectl config use-context default-context

# yum-cron daily
sed -i "s|^email_to = root|email_to = ${ADMIN_EMAIL}|" /etc/yum/yum-cron.conf
sed -i 's|^update_messages = no|update_messages = yes|' /etc/yum/yum-cron.conf
sed -i 's|^download_updates = no|download_updates = yes|' /etc/yum/yum-cron.conf
sed -i 's|^apply_updates = no|apply_updates = yes|' /etc/yum/yum-cron.conf
sed -i 's|^emit_via = stdio|emit_via = email|' /etc/yum/yum-cron.conf
# yum-cron hourly
sed -i "s|^email_to = root|email_to = ${ADMIN_EMAIL}|" /etc/yum/yum-cron-hourly.conf
sed -i 's|^update_cmd = default|update_cmd = security|' /etc/yum/yum-cron-hourly.conf
sed -i 's|^update_messages = no|update_messages = yes|' /etc/yum/yum-cron-hourly.conf
sed -i 's|^download_updates = no|download_updates = yes|' /etc/yum/yum-cron-hourly.conf
sed -i 's|^apply_updates = no|apply_updates = yes|' /etc/yum/yum-cron-hourly.conf
sed -i 's|^emit_via = stdio|emit_via = email|' /etc/yum/yum-cron-hourly.conf
